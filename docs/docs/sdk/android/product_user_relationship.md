# 用户关系

即时通讯 IM 支持用户关系管理能力，提供完整的社交关系管理方案：

- 支持用户关系存储能力, 包括: 好友关系和用户黑名单。
- 支持用户关系管理能力，包括:
  - 添加好友；
  - 删除好友； 
  - 添加好友至黑名单；
  - 将好友移除黑名单。
- 支持方便易用的客户端和服务端接口, 满足多种业务场景需求。

## 联系人列表

你可以对联系人列表进行相关管理操作，包括添加好友、删除好友、从服务端和本地获取联系人列表以及导入联系人列表。

联系人列表相关的限制，如单个用户的好友数上限，详见[产品使用限制](limitation.html#用户关系)。

### 添加好友

即时通讯 IM 支持每次添加单个好友。添加好友的流程如下：

- 服务端：调用 REST API 可直接将用户添加至联系人列表，要添加的好友无需确认。
- 客户端：例如，若用户 A 添加用户 B 为好友：用户 A 申请添加用户 B，用户 B 接到好友邀请后，选择同意或拒绝成为好友；若同意，则添加好友成功，则用户 A 和 B 均被添加到对方的联系人列表中。若拒绝，则添加好友失败。

好友表中的好友信息如下：

- 为哪个用户添加的好友。
- 好友的用户 ID。
- 好友备注（如果调用添加好友备注接口进行了设置）。
  
### 删除联系人

即时通讯 IM 支持每次删除单个联系人。删除联系人的同时会删除对方联系人列表中的该用户。

删除操作不需要对方同意或者拒绝。此外，删除联系人时支持选择是否保留其会话和消息。

### 获取联系人列表

- 利用服务端 API：
  - 可[调用推荐的方法分页获取联系人列表](/docs/sdk/server-side/user_relationship.html#分页获取好友列表)，其中每个好友对象包含好友的用户 ID 和备注。
  - 你也可以[调用之前的方法一次性获取所有联系人的列表](/docs/sdk/server-side/user_relationship.html#一次性获取好友列表)，该列表只包含联系人的用户 ID。
- 利用客户端 API：
  - 可调用推荐的方法[从服务器一次性或分页获取联系人列表](/docs/sdk/android/user_relationship.html#从服务端获取好友列表)，其中每个好友对象包含联系人的用户 ID 和备注。你也可以调用之前的方法一次性获取所有联系人的列表，该列表只包含联系人的用户 ID。 
  - 可一次性获取本地联系人列表或单个联系人的信息，包括联系人的用户 ID 和备注。
   
:::tip
需要从服务器获取联系人列表之后，才能从本地获取到联系人列表。
:::

### 导入联系人列表

你可以[调用 RESTful API](/docs/sdk/server-side/user_relationship.html#导入好友列表) 一次性导入多个联系人。

## 开启或关闭发送消息权限控制

单聊用户之间的消息通讯，包括好友之间和陌生人之间的通讯。例如，对于企业内部的移动办公 app 来说，企业内部同事之间可以互相发送消息，可能不需要消息发送权限控制，而对于一个交友类 app，可能要控制只有好友之间才能发送消息，陌生人之间若要发消息，需要发送好友邀请，同意加好友后才能发消息。

即时通讯 IM 默认支持陌生人之间发送单聊消息，即无需添加好友即可聊天。若仅允许好友之间发送单聊消息，你需要联系声网商务开通。该功能开通后，SDK 会在用户发起单聊时检查好友关系，若用户向陌生人发送单聊消息，SDK 会提示错误码 221。

## 黑名单

每个用户都有一份黑名单，用于保存被拉黑的用户。黑名单最多可添加 500 个用户。

用户可以将任何用户加入黑名单，不论该用户与你是否是好友关系。黑名单上的用户无法向你发送消息，也无法发送好友申请。好友被加入黑名单后仍在联系人列表上显示。

你可以[添加用户到黑名单](/docs/sdk/android/user_relationship.html#添加用户到黑名单)、[将用户从黑名单移除](/docs/sdk/android/user_relationship.html#将用户从黑名单移除)以及[从服务器和本地数据库获取黑名单](/docs/sdk/android/user_relationship.html#从服务器获取黑名单列表)。












